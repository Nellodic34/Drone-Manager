session_name: simulation
socket_name: drone
environment:
  ROS_DOMAIN_ID: "17"
pre_window: 
windows:
- window_name: px4
  layout: tiled
  panes:
    - shell_command:            
        # - cd ~/PX4-Autopilot
        # - make px4_sitl gz_x500_depth
        - cd ~/PX4-Autopilot
        - make px4_sitl gz_x500_depth
    - shell_command:
        - sleep 1          
        - MicroXRCEAgent udp4 -p 8888
    - shell_command:
        - sleep 2           
        - ros2 run ros_gz_bridge parameter_bridge /camera_info@sensor_msgs/msg/CameraInfo@gz.msgs.CameraInfo /camera@sensor_msgs/msg/Image@gz.msgs.Image /depth_camera@sensor_msgs/msg/Image@gz.msgs.Image 
          /model/x500_depth_0/odometry@nav_msgs/msg/Odometry@gz.msgs.Odometry  /clock@rosgraph_msgs/msg/Clock[gz.msgs.Clock
    - shell_command:
        - sleep 5  
        - cd ~/ros2_ws && source install/setup.bash
        - ros2 launch drone_manager rtabmap_sim.launch.py 
    - shell_command:
        - sleep 5  
        - cd ~/ros2_ws && source install/setup.bash
        # - ros2 run depth_image_proc point_cloud_xyz_node --ros-args -r image_rect:=/depth_camera 
        - ros2 run joy joy_node --ros-args -r use_sim_time:=true 
    - shell_command:
        - sleep 5
        - cd ~/ros2_ws && source install/setup.bash
        - LD_PRELOAD=/usr/lib/x86_64-linux-gnu/liboctomap.so ros2 run rviz2 rviz2 -d ~/ros2_ws/src/pkg/drone_manager/rviz/leo.rviz
    - shell_command:
        - sleep 5
        - cd ~/ros2_ws && source install/setup.bash
        - ros2 launch drone_manager tf_static_sim.launch.py use_sim_time:=true
- window_name: rtabmap
  layout: tiled
  panes:
    - shell_command:
        - sleep 25
        - cd ~/ros2_ws && source install/setup.bash
        - ros2 run drone_manager offboard_control --ros-args --params-file /root/ros2_ws/src/pkg/drone_manager/config/sim_params.yaml
    - shell_command:
        - sleep 5
        - cd ~/ros2_ws && source install/setup.bash
        - ros2 run drone_manager move_manager_node --ros-args --params-file /root/ros2_ws/src/pkg/drone_manager/config/sim_params.yaml
    - shell_command:
        - sleep 20
        - cd ~/ros2_ws && source install/setup.bash
        - ros2 topic echo /leo/drone/plan_status
    - shell_command:
        - sleep 30
        - cd ~/ros2_ws && source install/setup.bash
        - ros2 run drone_manager battery_node 
    - shell_command:
        - sleep 5
        - cd ~/ros2_ws && source install/setup.bash
        - ros2 launch drone_manager px4_tf_pub_simulation.launch.py use_sim_time:=true
    - shell_command:
        - sleep 30
        - cd ~/ros2_ws && source install/setup.bash
        - ros2 run drone_manager fsm_node 
    - shell_command:
        - sleep 5
        - cd ~/ros2_ws && source install/setup.bash
        - ros2 launch aruco_ros multi.launch.py marker_ids:=201,1,2 marker_sizes:=0.5,0.5,0.5
        #- ros2 topic pub /seed_pdt_drone/command std_msgs/msg/String "{data: 'takeoff'}" # to takeoff
        #- ros2 topic pub /seed_pdt_drone/command std_msgs/msg/String "{data: 'go(10.0,5.0,3.0)'}" # to plan without RRT and FCL
        #- ros2 topic pub /seed_pdt_drone/command std_msgs/msg/String "{data: 'flyto(goalX)'}" # X is a number 1-7
        #- ros2 topic pub /seed_pdt_drone/command std_msgs/msg/String "{data: 'teleop'}" # to trigger teleoperation 
        #- ros2 topic pub /seed_pdt_drone/command std_msgs/msg/String "{data: 'land'}"  # to land
        


